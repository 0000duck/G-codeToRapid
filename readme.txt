This is the original code from my master thesis in 2016.

Link to the paper: http://www.diva-portal.org/smash/record.jsf?pid=diva2%3A1034182&dswid=4335

At it is it fails to build the solution since the CommandBarButton is obsolete. So it Needs some updates to build again.